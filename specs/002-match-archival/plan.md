# –ü–ª–∞–Ω –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏—è –º–∞—Ç—á–µ–π

## 1. –ö–æ–Ω—Ç–µ–∫—Å—Ç –∏ —Ü–µ–ª–∏
- –°–Ω–∏–∑–∏—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ –æ—Å–Ω–æ–≤–Ω—É—é –ë–î –∏ –∫—ç—à, –æ–≥—Ä–∞–Ω–∏—á–∏–≤ ¬´–≥–æ—Ä—è—á–∏–π¬ª –Ω–∞–±–æ—Ä –º–∞—Ç—á–µ–π.
- –û–±–µ—Å–ø–µ—á–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥ –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö –º–∞—Ç—á–µ–π –≤ –∞—Ä—Ö–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º.
- –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Ç–µ–∫—É—â–∏–º–∏ API, WebSocket –∏ –∫—ç—à-—Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º–∏.
- –í—ã–ø–æ–ª–Ω–∏—Ç—å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Å—Ç–∏—Ç—É—Ü–∏–∏: multilevel cache, patch-based WS, —Å—Ç—Ä–æ–≥–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è.

## 2. –î–æ–ø—É—â–µ–Ω–∏—è –∏ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –ü–æ–ª–µ `match.is_archived` —É–∂–µ –¥–æ—Å—Ç—É–ø–Ω–æ –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –ø–æ –±—ç–∫–µ–Ω–¥—É/—Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É.
- –°–µ–∑–æ–Ω —Å—á–∏—Ç–∞–µ—Ç—Å—è –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–º, –∫–æ–≥–¥–∞ –≤—Å–µ –º–∞—Ç—á–∏ –≤ —Å—Ç–∞—Ç—É—Å–µ `FINISHED` –∏ –∑–∞–∫—Ä—ã—Ç –≤ `Season` (—Å—Ç–∞—Ç—É—Å –∏–ª–∏ –¥–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è).
- Redis –∏ PostgreSQL –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á –∏ –∏–Ω–¥–µ–∫—Å–æ–≤.
- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å —Å–º–æ–∂–µ—Ç –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞—Ç—å —Ä—É—á–Ω–æ–µ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –≤ –±—É–¥—É—â–µ–º).

## 3. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è
1. **–ß–∞—Å—Ç–∏—á–Ω—ã–π –∏–Ω–¥–µ–∫—Å PostgreSQL**
   - –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å `match_is_archived_false_idx` –Ω–∞ –∫–ª—é—á–µ–≤—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã (`season_id`, `status`, `match_date_time`) —Å —É—Å–ª–æ–≤–∏–µ–º `WHERE is_archived = false`.
   - –û–±–Ω–æ–≤–∏—Ç—å `docs/BD.md` –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é.
2. **–§–æ–Ω–æ–≤–∞—è –∑–∞–¥–∞—á–∞ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏—è**
   - –°–æ–∑–¥–∞—Ç—å BullMQ-–¥–∂–æ–±—É `archive-season-matches`.
   - –¢—Ä–∏–≥–≥–µ—Ä: –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é (cron) + —Ä—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω API.
   - –ê–ª–≥–æ—Ä–∏—Ç–º: –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ —Å–µ–∑–æ–Ω—ã ‚Üí –æ—Ç–º–µ—Ç–∏—Ç—å –º–∞—Ç—á–∏ –∫–∞–∫ –∞—Ä—Ö–∏–≤–Ω—ã–µ ‚Üí –æ–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å invalidate-—Å–æ–±—ã—Ç–∏—è –≤ Redis.
3. **–ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∫—ç—à–µ–π –∏ WS**
   - –ü—Ä–∏ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–∏: –æ—á–∏—Å—Ç–∏—Ç—å –∫–ª—é—á–∏ `md:*`, `season:*` –∏ –ø—É—à–∏—Ç—å WS-–ø–∞—Ç—á `match:{id}:stats` (—Ç–∏–ø `patch`, payload `archiveFlag: true`).
   - –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã –ø–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—é –∏ WS-–ø—Ä–æ—Ç–æ–∫–æ–ª—É.
4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏**
   - –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –º–∞—Ç—á–µ–π, –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, –≤–ª–∏—è–Ω–∏–µ –Ω–∞ Redis hit-rate.
   - –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –º–µ—Ç—Ä–∏–∫—É –¥–ª—è Retention/Tech Stability (üîµ/‚ö™ –Ω–∞–±–æ—Ä–∞).

## 4. –ü–ª–∞–Ω —Ä–∞–±–æ—Ç (–∏—Ç–µ—Ä–∞—Ü–∏–∏)
### –ò—Ç–µ—Ä–∞—Ü–∏—è A ‚Äî –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞
- –§–∏–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫—Ä–∏—Ç–µ—Ä–∏–∏ –∑–∞–≤–µ—Ä—à—ë–Ω–Ω–æ–≥–æ —Å–µ–∑–æ–Ω–∞ (–∏—Å—Ç–æ—á–Ω–∏–∫: `docs/project.md`, `docs/state.md`).
- –£—Ç–æ—á–Ω–∏—Ç—å, –∫–∞–∫–∏–µ API –¥–æ–ª–∂–Ω—ã —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å `is_archived = false` –∏ –≥–¥–µ –Ω—É–∂–µ–Ω –¥–æ—Å—Ç—É–ø –∫ –∞—Ä—Ö–∏–≤—É.
- –°–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ cron (–Ω–∞–ø—Ä–∏–º–µ—Ä, –µ–∂–µ–¥–Ω–µ–≤–Ω–æ 03:00 Europe/Moscow).

### –ò—Ç–µ—Ä–∞—Ü–∏—è B ‚Äî –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î
- –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é Prisma —Å —á–∞—Å—Ç–∏—á–Ω—ã–º –∏–Ω–¥–µ–∫—Å–æ–º + –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏.
- –û–±–Ω–æ–≤–∏—Ç—å `docs/BD.md` –∏ `audit/changes/XXXX-match-archival.md` (—á–µ—Ä–Ω–æ–≤–∏–∫).
- –ü—Ä–æ–≥–Ω–∞—Ç—å `prisma generate` –∏ smoke-—Ç–µ—Å—Ç—ã –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î.

### –ò—Ç–µ—Ä–∞—Ü–∏—è C ‚Äî –ë—ç–∫–µ–Ω–¥
- –î–æ–±–∞–≤–∏—Ç—å BullMQ-–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä `archiveMatchesWorker` (–ø–∞–ø–∫–∞ `backend/src/jobs`).
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å cron-—Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –≤ `server.ts` (–∏—Å–ø–æ–ª—å–∑—É—è —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π BullMQ scheduler).
- API: POST `/admin/matches/archive` –¥–ª—è —Ä—É—á–Ω–æ–≥–æ —Ç—Ä–∏–≥–≥–µ—Ä–∞ (—Å ETag –∏ ACL).
- –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∫—ç—à–∞ –∏ –ø—É–±–ª–∏–∫–∞—Ü–∏—è WS-–ø–∞—Ç—á–µ–π –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ñ–ª–∞–≥–∞.

### –ò—Ç–µ—Ä–∞—Ü–∏—è D ‚Äî –§—Ä–æ–Ω—Ç–µ–Ω–¥ –∏ UX
- –í –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å—Ç–∞—Ç—É—Å ¬´–ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω¬ª –∏ –∫–Ω–æ–ø–∫—É —Ä—É—á–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ).
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø—É–±–ª–∏—á–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —É—á–∏—Ç—ã–≤–∞—é—Ç `isArchived` (—Å–∫—Ä—ã–≤–∞—é—Ç –∏–∑ live-–ª–∏—Å—Ç–æ–≤).
- –û–±–Ω–æ–≤–∏—Ç—å `docs/style.md` –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤.

### –ò—Ç–µ—Ä–∞—Ü–∏—è E ‚Äî –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ù–∞–ø–∏—Å–∞—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –Ω–∞ –∞—Ä—Ö–∏–≤–∞—Ü–∏—é, –ø—Ä–æ–≤–µ—Ä—è—é—â–∏–µ –∫—ç—à/WS/–ë–î.
- –û–±–Ω–æ–≤–∏—Ç—å `docs/cache.md`, `docs/state.md`, `docs/roadmap.md`.
- –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ `audit/changes/<ID>.md` –∏ `audit/mcp-context7-summary.md`.

## 5. –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
- –ò–Ω–¥–µ–∫—Å—ã —Å–æ–∑–¥–∞–Ω—ã, –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç –≤ CI.
- Cron/—Ä—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏—è –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –º–∞—Ç—á–∏ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `FINISHED` –≤ –∞—Ä—Ö–∏–≤ –∏ –æ—á–∏—â–∞–µ—Ç –∫—ç—à.
- WS-–ø–∞—Ç—á —É–≤–µ–¥–æ–º–ª—è–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã, –∞–¥–º–∏–Ω UI –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å—Ç–∞—Ç—É—Å.
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –º–µ—Ç—Ä–∏–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã, `npm run build`.

## 6. –†–∏—Å–∫–∏ –∏ –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è
- **–†–∏—Å–∫ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –ë–î**: –±–∞—Ç—á–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ 200 –º–∞—Ç—á–µ–π, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `FOR UPDATE SKIP LOCKED`.
- **–†–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ –∫—ç—à–∞**: –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø—É–±–ª–∏–∫–∞—Ü–∏—è invalidate-—Å–æ–±—ã—Ç–∏–π –∏ ETag bump.
- **–†–µ–≥—Ä–µ—Å—Å–∏—è UI**: –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ—Ç—å —Ñ–ª–∞–≥ –∏–∫–æ–Ω–∫–∏ —Ç–æ–ª—å–∫–æ –≤ –∞–¥–º–∏–Ω–∫–µ, –ø—É–±–ª–∏—á–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã ‚Äî read-only.
- **Cron –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç —Å–µ–∑–æ–Ω**: –¥–æ–±–∞–≤–∏—Ç—å fallback-–ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∞–¥–º–∏–Ω–∞/worker.

## 7. –°–ª–µ–¥—É—é—â–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã
- –ú–∏–≥—Ä–∞—Ü–∏—è Prisma `2025XXXX_match_archival_index`.
- Worker `backend/src/jobs/archiveMatchesWorker.ts` –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ç–æ—Ä –≤ `server.ts`.
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–æ–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (state/cache/roadmap/BD).
