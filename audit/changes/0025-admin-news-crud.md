# 0025-admin-news-crud

Дата: 10 октября 2025 г.
Ответственный: GitHub Copilot

## Что было
- В админ-панели новости можно было только создавать; для исправлений приходилось править записи в БД вручную.
- Публичный storefront не получал сигнала об удалении новости, приходилось ждать повторного запроса.

## Что стало
- `backend/src/routes/adminRoutes.ts`
  - Добавлены эндпоинты `PATCH /api/admin/news/:newsId` и `DELETE /api/admin/news/:newsId` с валидацией данных и ETag-инвалидацией.
  - Публикация событий `news.full` при обновлении и `news.remove` при удалении, чтобы фронтенды синхронно обновлялись.
- `admin/src/api/adminClient.ts`
  - Добавлены `adminPatch` и понятные сообщения об ошибках для новостных операций.
- `admin/src/store/adminStore.ts`
  - Хранилище теперь поддерживает `updateNews` и `removeNews`, чтобы лента синхронизировалась без ручного refetch.
- `admin/src/components/tabs/NewsTab.tsx`
  - Форма новостей поддерживает режим редактирования, отмену и удаление с подтверждением.
  - Превью карточек отображает кнопки "Редактировать"/"Удалить" и подсвечивает активную запись.
- `admin/src/app.css`
  - Актуализирована стилизация для экшенов и режима редактирования.
- `frontend/src/components/NewsSection.tsx`
  - WebSocket-клиент обрабатывает событие `news.remove`, моментально скрывая удалённые записи.

## Тестирование
- CRUD-потоки проверены через админ-панель: создание, редактирование, удаление с последующим обновлением публичного приложения.
